;  NUVRPT.PO / POR - D11
;
;		CREATED: 08-JUN-94
;		AUTHOR:  DIANA K. SCHEPPA
;
;		VENDORY INVENTORY REPORT BY NUAIRE PART NUMBER
;
; REVISIONS:
;
;**********************************************************************
;		PURCHASE ORDER PROCESSING
;**********************************************************************
;:
;		COMPILE & LINK PER DOCUMENTATION INSTALLATION NOTES.
;
;
;
RECORD VIPART
	.INCLUDE 'DEF:RD061A.DEF'

RECORD PLINE
 		,A132
RECORD LINE1,X
	KPART	,A15
		,A5
	KVNO	,A6
		,A5
	KVPART	,A20

RECORD HDR1
		,A13,	'NUAIRE PART #'
		,A7
		,A8,	'VENDOR #'
		,A3
		,A13,	'VENDOR PART #'

RECORD LEGEND
		,A1
		,A19,'NUAIRE NUMBERS FROM'
		,A1
	SNO	,A15
		,A3
		,A2,'TO'
		,A3
	ENO	,A15

RECORD
	CNGCTL	,D1
	WHATNO	,D1
	TNUM	,D3
	TMPREC	,D5
	ALL	,A12
	BLANKS	,A15
	BRACKS	,A30,']]]]]]]]]]]]]]]]]]]]]]]]]]]]]]'
	BSMID	,D5
	CNTR	,D3
	DSPSW	,D1
	EOF	,D1
	IDFLAG	,D1
	LINCNT	,D2,	60
	LINCTL	,D1
	LOKCTL	,D1
	LPSW	,D1
	NOABRT	,D1,	1
	PGCNT	,D3,	000
	PRTCTL	,D3
	PRTTYP	,A1
	READ	,D1,	0
	WRITE	,D1,1
	RPTNUM	,D3
	SPLFIL	,A14
	SRCOPT	,D1
	SRCCTL	,D1
	SWITCH	,D1
	TITLE	,A35,	'VENDOR/INVENTORY REPORT BY NUAIRE #'
	TODAY	,D6
	V	,D1
	WTARG	,D1,	2
	XRECNO	,D5
	LRECNO	,D5
	NORECS	,D5
	INXCTL	,D1
	ENTRY	,A15
	SITEM	,A15
	EITEM	,A15
	YN	,D1


PROC
	XCALL TERID (V)
	XCALL OUTPT (2,1,2,'PRINT VENDOR/INVENTORY REPORT BY NUAIRE #',1)
	LINCNT = 60
	PGCNT = 0

GETSNO,
	XCALL OUTPT (4,20,2,'PLEASE ENTER STARTING NUAIRE NUMBER',V)
	XCALL INPUT (4,60,15,0,'AE',ENTRY,INXCTL,V)
	GO TO (GETSNO,ENDOFF), INXCTL
	SITEM = ENTRY (1,15)
	SNO = SITEM
GETENO,
	XCALL OUTPT (5,20,2,'PLEASE ENTER ENDING NUAIRE NUMBER',V)
	XCALL INPUT (5,60,15,0,'A ',ENTRY,INXCTL,V)
	GO TO (GETSNO,GETSNO), INXCTL
	EITEM = ENTRY (1,15)
	IF (EITEM.EQ.'    ') EITEM = SITEM
	XCALL OUTPT(5,60,0,EITEM,V)
	ENO = EITEM
	IF (EITEM.EQ.'  ') CALL ALLITM
	GOTO START
ALLITM,
	ALL = 'ALL PARTS'
	SITEM=
	EITEM='ZZZZZZZZZZZZZZZ'
	SNO = ALL
	ENO = 
	XCALL OUTPT(5,60,0,ALL,V)
	RETURN 
START,
	YN = INXCTL
	CNGCTL=2
	XCALL ANYCN(CNGCTL,WHATNO)
	GOTO (GETSNO),CNGCTL
	XCALL WATE (4,V)
	XCALL RDATE (TODAY)
	SPLFIL(5,6) = 'N2'

	LPSW = 1
	XCALL LPON (LPSW,SPLFIL)
	IF (LPSW.EQ.0) GO TO EXIT
	IF (LPSW.EQ.2) WTARG = 4
	XCALL WATE (WTARG,V)
OPNFIL,
	SWITCH = 1
	XCALL FILES (2,'SI',61,SWITCH)
	IF (SWITCH.EQ.9) GOTO ENDOFF
PRTRPT,
	XCALL WATE (2,V)
	VPKEY1 =
	IPART = 
	IVEN = 
PRLOOP,
	XCALL IOS (2,VIPART,READ,LOKCTL)
;;	XCALL ISIO (2,VIPART,VPKEY1,READ,LOKCTL)
	IF (LOKCTL.EQ.2) GOTO DONE
CONTIN,
	IF (VPART.EQ.']]]DEL') GOTO PRLOOP
	IF (IPART.LT.SITEM) GOTO PRLOOP
	IF (IPART.GT.EITEM) GOTO DONE
	KVNO = IVEN
	KVPART = VPART
	KPART = IPART
	CALL PRINT
RNEXT,
	GOTO PRLOOP
DONE,
	XCALL LPOFF (LPSW,SPLFIL,PGCNT)
	XCALL WATE (3,V)
	GO TO EXIT
PRINT,
	PRTCTL = 132
	LINCTL = 1
	XCALL LPOUT (LINCNT,PGCNT,PLINE,TITLE,HDR1,'NO HDR',' ',
&		LEGEND,'NO LEGEND',' ',LINCTL,132,PRTCTL,0,LPSW,RPTNUM,PRTTYP)
	RETURN

EXIT,
	XCALL FILES (2,'SI',61,4)
;**********************************************************************
ENDOFF,
	XCALL PGCHN ('PO:VIMENU',1)
;**********************************************************************

END

