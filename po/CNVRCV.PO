;  CNVRCV / PO - D11
;
;		CREATED:  09-FEB-95
;		AUTHOR:   DIANA K. SCHEPPA
;**********************************************************************
;		PROGRAM TO CONVERT THE RECEIVINGS HISTORY FILE FROM A
;		SEQUENTIAL FILE TO AN ISAM FILE. ALSO ADDED A PN # FOR
;		SPECIALS
;
;		RECORD LENGTH:   OLD: 185      NEW: 195
;
;
RECORD RCVHST
	.INCLUDE 'DEF:RD154A.DEF'

RECORD OLDRCV			;RECORD LENGTH: 185
		,A185

RECORD OLDCTL
		,A167
	OCVALS	,A18

RECORD
	BLANKS	,A5
	SWITCH	,D1,1
	CNGCTL	,D1
	NEWSIZ	,D4
	ENTRY	,A6
	INXCTL	,D1
	MAXREC	,D5
	V	,D1
	READ	,D1,	0
	LOKCTL	,D1
	KEY	,A4
	SRCCTL	,D1
	BSMID	,D5
	VREC	,D5
	STORE	,D1,	3
	

PROC
	XCALL TERID (V)
	V = 1
BEGIN,
	CNGCTL =
	XCALL OUTPT(01,01,3,'CONVERT RCVHST FILE TO AN ISAM LAYOUT',V)
	XCALL OUTPT(12,17,2,'ARE YOU SURE YOU WISH TO RUN THIS PROGRAM ?',V)
	XCALL INPUT(12,62,01,01,'YN',ENTRY,INXCTL,V)
	GO TO (END), INXCTL-1
PROCES,
	XCALL WAIT (4,V)
;;	OPEN (1,I,'TST:RCVHST.TST')
	OPEN (1,I,'DPO:RCVHST.NUA')
;;	OPEN (2,O,'TST:RCVHST.NEW')
	SWITCH = 1
	XCALL FILES (2,'SU',154,SWITCH)
	VREC = 1
NXTVEN,
	READS (1,OLDRCV,EOF1)
	IF (OLDRCV.EQ.']]]]]]') GO TO EOF1
	INCR VREC
	XCALL OUTPT (22,5,0,VREC,V)
ADDREC,
	RCVHST(1,185) = OLDRCV(1,185)
	LOKCTL = 1
	XCALL ISIO (2,RCVHST,RCVKEY,STORE,LOKCTL)
	GO TO NXTVEN
EOF1,
	OFF ERROR
	CLOSE 1
	XCALL FILES (2,'SU',154,4)
END,
	CLOSE 15
	XCALL PGMND
	STOP

END

