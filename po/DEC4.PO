SUBROUTINE DEC4
	in	,a
	out	,d

RECORD	VARS
	ALPHA	,A18
	NUM	,D18
	ANUM	,A18
	LN	,D8
	DP	,D8
	DEC	,D8
	I	,D8
PROC
	CLEAR OUT, ANUM
	ALPHA=IN
	LN=%TRIM(ALPHA)
	IF(LN.EQ.0)RETURN

	DP=%INSTR(1,ALPHA(1,LN),'.')
	USING DP SELECT
	(0),	BEGIN			;NO DECIMAL PT 
		DEC = 0
		ANUM = ALPHA
		END
	(1),	BEGIN			;DECIMAL PT IS 1ST CHAR
		DEC = LN - DP		;NUMBER OF DECIMAL PLACES
		ANUM = ALPHA(2,LN)	
		END
	(),	BEGIN
		DEC = LN - DP		;NUMBER OF DECIMAL PLACES
		ANUM = ALPHA(1,DP-1)	;DIGITS BEFORE DEC PT
		IF(LN.GT.DP) ANUM(DP,LN-1) = ALPHA(DP+1,LN)
		END
	ENDUSING

	ONERROR NOT_NUM
	NUM=ANUM
	OFFERROR

	USING DEC SELECT
	(0),	IF(DP.GT.0)NUM=NUM*10000
	(1),	NUM=NUM*1000
	(2),	NUM=NUM*100
	(3),	NUM=NUM*10
	ENDUSING

	OUT=NUM
	RETURN
NOT_NUM,
	OFFERROR
	CLEAR OUT
	RETURN
	END

