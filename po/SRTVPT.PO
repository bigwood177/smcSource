;  SRTVPX / POR - D11
;
;
;;;INPUT:VPTIDX
;;;WORK:3
;;;OUTPUT:VPTIDX
RECORD	VPTIDX		; 
		; VENDOR PART # FILE INDEX 
		; RECORD SIZE = 24
		;
		; ALL SORT KEYS NEED TO BE ALPHA WHEN YOU ARE
		; USING A CIS CHIP - AUG 83 PATCH FROM MCBA
	VPTKEY	,A19	; KEY (INV. PART # & VENDOR #)
	IRC061	,A5	; RELATIVE RECORD NUMBER IN VIPART FILE
;:
;;;KEYS:VPTKEY
;;;PAD:]
;;;SYSTEM:
;;;END:
;dbl sort template

RECORD	FFILE
	FILNUM	,D3
	CLCTL	,D1
	REDFIL	,A14

RECORD SNDMSG
		,A3
		,A6
	RCNT	,D5
	OCNT	,D5
	MFIL	,D3
		,A3

RECORD,X
	PRGNAM	,A9

RECORD	HEADER
		,A7,	'DBSORT '
	HFILE	,A14

RECORD	VARS
	V	,D1
	MSG	,A14
	XFIL	,D3,	062
	SWITCH	,D1
PROC
	XCALL TERID (V)

	SWITCH = 1
	XCALL SNMSG (SNDMSG,SWITCH)	;GET MESSAGE, IF ANY
	IF (SWITCH .EQ. 9) 
	THEN	BEGIN
		FILNUM = XFIL
		END
	ELSE	BEGIN
		FILNUM = MFIL
		SWITCH = 3
		XCALL SNMSG (' ',SWITCH)	;DELETE MESSAGE
		END
NOMSG,
	XCALL FFILE (FILNUM,REDFIL,CLCTL)	;GET FILE SPEC
	HFILE = REDFIL

	XCALL OUTPT (2,1,2,HEADER,1)

	SORT (IN=REDFIL, RECORD=VPTIDX, 
&		KEY=(VPTKEY) )

	XCALL PGCHN (PRGNAM,1)
	END

